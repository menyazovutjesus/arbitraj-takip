"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getAssetPairsTicker = exports.getAssetPairTicker = exports.getAssetPairTickerOriginal = void 0;
const node_fetch_1 = __importDefault(require("node-fetch"));
const pairConversion_1 = require("./pairConversion");
/**
 * Get current original kraken asset pairs result
 *
 * @code
 * ```
 * const bitcoin = getAssetPairTickerOriginal('XBTUSD');
 * const bitcoinEth = getAssetPairTickerOriginal('XBTUSD', 'XETHXXBT');
 * ```
 */
const getAssetPairTickerOriginal = async (...pairs) => {
    const request = await node_fetch_1.default("https://api.kraken.com/0/public/Ticker?pair=" + pairs.join(","));
    const response = await request.text();
    return JSON.parse(response.replace(/\%$/, ""));
};
exports.getAssetPairTickerOriginal = getAssetPairTickerOriginal;
/**
 * Get current asset pairs result
 *
 * @code
 * ```
 * const bitcoin = getAssetPairTicker('XBTUSD');
 * ```
 */
const getAssetPairTicker = async (pair) => (await exports.getAssetPairsTicker(pair))[pair];
exports.getAssetPairTicker = getAssetPairTicker;
/**
 * Get multiple asset pairs result in a signgle request
 *
 * @code
 * ```
 * const bitcoinEth = getAssetPairsTicker('XBTUSD', 'XETHXXBT');
 * console.log(bitcoinEth.XBTUSD);
 * ```
 */
const getAssetPairsTicker = async (...pairs) => {
    const response = await exports.getAssetPairTickerOriginal(...pairs);
    if (response.error && response.error.length) {
        return Promise.reject(response.error);
    }
    return pairConversion_1.convertToObjectNotation(response.result);
};
exports.getAssetPairsTicker = getAssetPairsTicker;
